# minitalk

Unixシグナルを用いたプロセス間通信システム。SIGUSR1とSIGUSR2のみを使用してサーバーとクライアント間でメッセージ送信を実現します。

## 目次

- [概要](#概要)
- [特徴](#特徴)
- [インストール](#インストール)
- [使用方法](#使用方法)
- [動作原理](#動作原理)
- [プロジェクト構造](#プロジェクト構造)
- [技術的詳細](#技術的詳細)

## 概要

minitalkは42 Schoolのプロジェクトで、Unixシグナルを用いたプロセス間通信を実装しています。メッセージを受信するサーバーと、文字列メッセージを1文字ずつビット単位でシグナル送信するクライアントで構成されています。

## 特徴

- **シグナルベース通信**: データ送信にSIGUSR1とSIGUSR2のみを使用
- **ビット単位送信**: 各文字を8ビット（MSBファースト）で個別送信
- **非同期処理**: サーバーはシグナルハンドラを使用して非同期でシグナルを処理
- **プロセス識別**: 特定のサーバープロセスをターゲットにするためのPIDを使用
- **カスタムライブラリ**: コア機能にカスタムlibftライブラリを使用

## インストール

1. リポジトリをクローン:
```bash
git clone https://github.com/hayatosann/minitalk.git
cd minitalk
```

2. プロジェクトをビルド:
```bash
make
```

これにより`server`と`client`の2つの実行ファイルが作成されます。

## 使用方法

1. **サーバーを起動:**
```bash
./server
```
サーバーはPID（プロセスID）を表示し、メッセージの受信を待機します。

2. **クライアントからメッセージを送信:**
```bash
./client <server_pid> "送信したいメッセージ"
```

### 実行例

```bash
# ターミナル1 - サーバー起動
$ ./server
12345

# ターミナル2 - メッセージ送信
$ ./client 12345 "Hello, World!"
```

メッセージ "Hello, World!" がサーバーターミナルに表示されます。

## 動作原理

### シグナルプロトコル

- **SIGUSR1**: バイナリ'1'を表現
- **SIGUSR2**: バイナリ'0'を表現
- **送信方式**: MSB（最上位ビット）ファースト、1文字につき8ビット
- **タイミング**: シグナル損失を防ぐため、ビット送信間に1msの遅延

### 通信フロー

1. **クライアント**: 各文字を8ビットに変換し、`kill()`システムコールで送信
2. **サーバー**: シグナルハンドラでシグナルを受信し、ビット単位で文字を再構築
3. **出力**: サーバーは完全に再構築されたメッセージを表示

## プロジェクト構造

```
minitalk/
├── src/
│   ├── server.c         # サーバー実装
│   ├── client.c         # クライアント実装
│   └── minitalk.h       # ヘッダーファイル
├── libft/               # カスタムCライブラリ
└── Makefile             # ビルド設定
```

## 技術的詳細

### サーバー (`src/server.c`)

- シグナルハンドラ内で状態管理に静的変数を使用
- ビットシフト演算を使用した文字の再構築
- 同じハンドラ関数でSIGUSR1とSIGUSR2の両方を処理
- シグナル間の効率的な待機に`pause()`を使用

### クライアント (`src/client.c`)

- ビット操作を使用した文字のバイナリ変換
- `kill()`システムコールを使用してMSBファーストでビットを送信
- 信頼性のある送信を確保するため`usleep(1000)`でタイミング遅延を実装
- コマンドライン引数の検証

### ビルドシステム

- **コンパイラフラグ**: 厳密なコンパイルのため`-Wall -Wextra -Werror`
- **依存関係**: カスタムlibftライブラリとリンク
- **ターゲット**: `make`, `make clean`, `make fclean`, `make re`

---

## ライセンス

このプロジェクトは42 Schoolカリキュラムの一部です。
